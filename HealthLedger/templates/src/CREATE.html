<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create New Employee</title>
  {% load static %}
  <link href="{% static 'output.css' %}" rel="stylesheet">
</head>

<body class="bg-zinc-900 min-h-screen text-zinc-100">
  <!-- Navbar -->
  <nav class="bg-zinc-800 border-b border-zinc-700 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center">
          <div class="text-xl font-semibold text-zinc-100">Employee Manager</div>
        </div>
        <div class="hidden md:flex space-x-6">
          <a class="text-zinc-400 hover:text-zinc-300" onclick="window.location.href='/'">Dashboard</a>
          <a class="text-zinc-400 hover:text-zinc-100" onclick="window.location.href='/view_all'">Records</a>
          <a href="#" class="text-zinc-400 hover:text-zinc-100">Analytics</a>
          <a href="#" class="text-zinc-400 hover:text-zinc-100">Settings</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="max-w-full mx-auto px-4 py-12 sm:px-6 lg:px-8">
    <div class="bg-zinc-800 rounded-lg shadow-2xl overflow-hidden">
      <div class="px-8 py-6 border-b border-zinc-700">
        <h1 class="text-2xl font-semibold text-zinc-100">Add New Employee Record</h1>
      </div>

      <div class="p-8">
        <form id="employeeForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- EMP_ID -->
          <div class="flex flex-col">
            <label for="emp_id" class="text-sm font-medium text-zinc-400 mb-2">Employee ID</label>
            <input type="text" id="emp_id" name="emp_id" placeholder="EMP001"
              class="bg-zinc-700 border-0 rounded-lg px-4 py-3 text-zinc-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-zinc-800">
            <p class="mt-2 text-xs text-zinc-500">Enter unique Employee ID</p>
          </div>

          <!-- NAME -->
          <div class="flex flex-col">
            <label for="name" class="text-sm font-medium text-zinc-400 mb-2">Employee Name</label>
            <input type="text" id="name" name="name" placeholder="Enter employee name"
              class="bg-zinc-700 border-0 rounded-lg px-4 py-3 text-zinc-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-zinc-800">
          </div>

          <!-- SALARY -->
          <div class="flex flex-col">
            <label for="salary" class="text-sm font-medium text-zinc-400 mb-2">Salary</label>
            <input type="number" id="salary" name="salary" placeholder="e.g. 55000"
              class="bg-zinc-700 border-0 rounded-lg px-4 py-3 text-zinc-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-zinc-800">
          </div>

          <!-- DEPARTMENT -->
          <div class="flex flex-col">
            <label for="department" class="text-sm font-medium text-zinc-400 mb-2">Department</label>
            <select id="department" name="department"
              class="bg-zinc-700 border-0 rounded-lg px-4 py-3 text-zinc-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-zinc-800">
              <option value="">Select department</option>
              <option value="HR">HR</option>
              <option value="Finance">Finance</option>
              <option value="IT">IT</option>
              <option value="Marketing">Marketing</option>
              <option value="Sales">Sales</option>
              <option value="Operations">Operations</option>
              <option value="Support">Support</option>
            </select>
          </div>

          <!-- BONUS -->
          <div class="flex flex-col">
            <label for="bonus" class="text-sm font-medium text-zinc-400 mb-2">Bonus</label>
            <input type="number" id="bonus" name="bonus" placeholder="e.g. 5000"
              class="bg-zinc-700 border-0 rounded-lg px-4 py-3 text-zinc-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-zinc-800">
          </div>

          <!-- Message Container -->
          <div class="md:col-span-2 hidden" id="messageContainer">
            <div id="successMessage"
              class="hidden bg-green-900/30 border border-green-700 text-green-400 px-4 py-3 rounded-lg">
              ✅ Employee record created successfully!
            </div>
            <div id="errorMessage"
              class="hidden bg-red-900/30 border border-red-700 text-red-400 px-4 py-3 rounded-lg">
              ❌ Error creating record. Please try again.
            </div>
          </div>

          <!-- Buttons -->
          <div class="md:col-span-2 flex flex-col-reverse sm:flex-row gap-3 pt-4">
            <button type="button" onclick="window.history.back()"
              class="flex-1 px-6 py-3 bg-zinc-700 hover:bg-zinc-600 text-zinc-400 hover:text-zinc-100 rounded-lg transition">
              Cancel
            </button>
            <button type="submit"
              class="flex-1 px-6 py-3 bg-zinc-200 hover:bg-zinc-100 text-zinc-900 font-medium rounded-lg transition">
              Save Record
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script>
    document.getElementById('employeeForm').addEventListener('submit', function (e) {
      e.preventDefault();

      const formData = {
        emp_id: document.getElementById('emp_id').value,
        name: document.getElementById('name').value,
        salary: document.getElementById('salary').value,
        department: document.getElementById('department').value,
        bonus: document.getElementById('bonus').value
      };

      const messageContainer = document.getElementById('messageContainer');
      const successMessage = document.getElementById('successMessage');
      const errorMessage = document.getElementById('errorMessage');
      messageContainer.classList.remove('hidden');

      // Send data to backend API
      const params = new URLSearchParams(formData).toString();
      fetch(`/api/add_new_data/?${params}`, { method: 'GET' })
        .then(res => res.json())
        .then(data => {
          if (data.status) {
            successMessage.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            setTimeout(() => {
              document.getElementById('employeeForm').reset();
              messageContainer.classList.add('hidden');
              successMessage.classList.add('hidden');
            }, 3000);
          } else {
            errorMessage.classList.remove('hidden');
            successMessage.classList.add('hidden');
          }
        })
        .catch(() => {
          errorMessage.classList.remove('hidden');
          successMessage.classList.add('hidden');
        });
    });
  </script>
</body>
</html>
